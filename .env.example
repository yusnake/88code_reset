# ========================================
# 88code 订阅重置工具 - 环境变量配置样例
# ========================================

# ============ Web 管理模式（推荐） ============

# Web 管理员认证 Token（必填）
# 用于访问 Web 管理界面的密码
# 强烈建议修改为强密码！
WEB_ADMIN_TOKEN=admin123

# Web 服务器端口（可选）
# 默认: 8966
# WEB_PORT=8966


# ============ 传统模式（兼容旧版本） ============
# 注意: Web 模式下不需要配置 API_KEY
# 只有使用 --profile legacy 启动 reset-scheduler 时才需要

# API Key（传统模式必填）
# 单个 API Key 或多个（用逗号分隔）
# 示例: API_KEY=sk-ant-xxx,sk-ant-yyy
# API_KEY=

# 或使用 API_KEYS（与 API_KEY 等效）
# API_KEYS=

# 时区配置（默认: Asia/Shanghai）
# TIMEZONE=Asia/Shanghai

# 目标套餐名称（留空=所有 MONTHLY 套餐）
# 多个套餐用逗号分隔，例如: FREE,PRO,PLUS
# PLANS=

# 额度上限百分比（0-100，默认: 83）
# 上限模式：当额度百分比 > 上限时，跳过18点重置
# 例如：设置为83，表示当前额度超过83%时不执行18点重置（保留重置机会到23:55）
# CREDIT_THRESHOLD_MAX=83

# 额度下限百分比（0-100，无默认值）
# 下限模式：当额度百分比 < 下限时，才执行18点重置
# 例如：设置为50，表示只有当前额度低于50%时才执行18点重置
# CREDIT_THRESHOLD_MIN=

# 是否启用18:55重置（默认: false/关闭）
# 可选值：true, false, 1, 0, yes, no, on, off, enabled, disabled
# ENABLE_FIRST_RESET=false


# ============ 高级配置（可选） ============

# API Base URL
# 默认: https://www.88code.org
# BASE_URL=https://www.88code.org

# 数据目录
# 默认: ./data
# DATA_DIR=/app/data

# 日志目录
# 默认: ./logs
# LOG_DIR=/app/logs


# ========================================
# 使用说明
# ========================================

# 1. Web 模式（推荐）：
#    - 只需要设置 WEB_ADMIN_TOKEN
#    - 所有 API Key 通过 Web 界面管理
#    - 配置文件使用: cp .env.example .env
#    - 修改 WEB_ADMIN_TOKEN 为强密码
#    - 启动命令: docker-compose up -d reset-web
#    - 访问地址: http://localhost:8966

# 2. 传统模式（兼容旧版）：
#    - 需要设置 API_KEY 或 API_KEYS
#    - 使用环境变量配置 API Key
#    - 启动命令: docker-compose --profile legacy up -d reset-scheduler
#    - 适用于不想使用 Web 界面的场景

# 3. 测试模式：
#    - 需要设置 API_KEY
#    - 测试 API 连接和订阅信息
#    - 启动命令: docker-compose --profile test run reset-test


# ========================================
# 快速开始（Web 模式）
# ========================================

# 步骤 1: 复制此文件
# cp .env.example .env

# 步骤 2: 修改管理员密码
# 编辑 .env 文件，将 WEB_ADMIN_TOKEN 改为你的强密码

# 步骤 3: 启动服务
# docker-compose up -d reset-web

# 步骤 4: 访问管理界面
# 浏览器打开: http://localhost:8966
# 输入你设置的管理员密码

# 步骤 5: 添加 Token
# 在 Web 界面点击"添加新 Token"
# 输入名称和 API Key，系统会自动获取订阅信息


# ========================================
# 安全提示
# ========================================

# 1. 修改默认密码
#    WEB_ADMIN_TOKEN 默认值 admin123 仅用于演示
#    生产环境务必修改为强密码

# 2. 仅本地访问
#    如果只在本地使用，修改 docker-compose.yml:
#    ports:
#      - "127.0.0.1:8966:8966"

# 3. 使用反向代理
#    生产环境建议使用 Nginx + HTTPS

# 4. 不要提交 .env 到 Git
#    .env 文件已在 .gitignore 中，包含敏感信息不应提交

# 5. API Key 保护
#    添加的 API Key 保存在 ./data/tokens.json
#    请妥善保管该文件，不要公开分享


# ========================================
# 故障排查
# ========================================

# Web 界面无法访问:
# - 检查端口是否被占用: netstat -tulpn | grep 8966
# - 查看日志: docker-compose logs reset-web
# - 确认防火墙设置

# Token 添加失败:
# - 检查 API Key 格式是否正确（sk-ant-开头）
# - 确认网络可以访问 www.88code.org
# - 查看详细错误信息

# 重置未执行:
# - 检查 Token 是否启用（Web 界面显示为绿色）
# - 确认重置配置已保存
# - 查看"系统状态"中的下次重置时间
# - 检查日志: docker-compose logs reset-web
